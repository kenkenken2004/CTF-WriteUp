# Imaginary
### 解説
- 与えられた"app.py"を見ると、**プログラムの複素数の辞書のキーに"1337i"がある状態でメニューで5を入力**すればいいことがわかる。
- であるが、実部に0,虚部に1337を入力したところで、"0+1337i"となるので合致しない。
- ここで、**ImportとExport**機能に着目する。
- ImportはAESで暗号化されたJSONデータから辞書を読み込む。Exportはその逆である。
- つまり、"1337i"をキーに含むような暗号化されたデータをImportすればよい。
- ただし、AESの鍵は既定だが非公開であるため直接の暗号化は不可能である。
- そこで、このプログラムでは**ECBモード**が用いられていることに着目する。
- ECBモードはブロック暗号において、平文を直接分割してそれぞれ暗号化し、再び結合するというものである。
- これには、**ブロックを入れ替える**ことで、暗号・復号することなく平文の操作が可能となるという脆弱性がそんざいする。
- そこで、以下の2つの辞書をそれぞれExportする。
    1. **11111+111iと1+1i**
    2. **11111111111+1337i**
- JSON表現するとこうなる。
    1. **{"11111 + 111i": \[11111, 111\], "1 + 1i": \[1, 1\]}〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇〇**
    2. **{"11111111111 + 1337i": \[11111111111, 1337\]}〇〇〇〇**
- 暗号化されたものは、
    1. **d6b8163b4cbae89b75c94ae45146fcfa7aabfdc6c2e0e8caf3592fc25119e40c450ebe4d6d0ea85378c0212781ca5cdd8db4341b6d2b363abdc9d13de3042f42**
    2. **3c2b26cd98a6d770deb7356444e7c525c2d4a53f38d83a1b4cf782f97a51929df0cb8131302c57f751d36ea7f7d5f2e1**
- AESのブロック長は16バイトであるため、**16文字ごと**に別々に暗号化される。なお、ブロック長に満たない場合はパディングで残りが埋められ、それは〇で表現している。
- 一つ目暗号文のの前半32バイトは「**{"11111 + 111i": \[11111, 111\], "**」を暗号化したものである。
- 二つ目の暗号文の後半32バイトは「**1337i": \[11111111111, 1337\]}〇〇〇〇**」を暗号化したものである。
- これら2つを結合すると、「**{"11111 + 111i": \[11111, 111\], "1337i": \[11111111111, 1337\]}〇〇〇〇**」を暗号化したものに相当する 
  **d6b8163b4cbae89b75c94ae45146fcfa7aabfdc6c2e0e8caf3592fc25119e40cc2d4a53f38d83a1b4cf782f97a51929df0cb8131302c57f751d36ea7f7d5f2e1**
  が得られる。
- これをImportすれば辞書に**1337i**が登録されるため、メニューで5を入力すればflagが表示される。

